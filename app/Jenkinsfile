pipeline {
    agent any

    environment {     
        DOCKERHUB_CREDENTIALS= credentials('dh')     
    }


    stages {          
        stage('Build') {
            steps {
                script {
                    sh "docker build -f app/Dockerfile -t $DOCKERHUB_CREDENTIALS_USR/cicd_challenge:$BUILD_NUMBER ."
                }
                echo 'Build done!'
            }
        }
        // stage('Test') {
        //     steps {
        //         script {
        //             sh "npm test"
        //             echo 'Test passed! wii'
        //         }
                
        //     }
        // }
        stage('Release') {
            steps {
                script {
                    sh "docker push $DOCKERHUB_CREDENTIALS_USR/cicd_challenge:$BUILD_NUMBER"
                    echo 'Release mounted! siu'
                }
                
            }
        }
    }
}